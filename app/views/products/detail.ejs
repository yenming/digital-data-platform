<%- include('../layouts/main', {
    title: product.name + ' - ' + product.category + ' | OrionStar Taiwan',
    description: product.description.substring(0, 160) + '... 專業的' + product.category + '解決方案，提供完整的技術規格和服務支援。',
    keywords: product.name + ',' + product.category + ',送餐機器人,服務型機器人,遞送機器人,工廠機器人,智能機器人,自動化設備',
    page: 'products',
    body: `
<!-- 結構化數據 JSON-LD -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "${product.name}",
  "description": "${product.description}",
  "category": "${product.category}",
  "brand": {
    "@type": "Brand",
    "name": "OrionStar Taiwan"
  },
  "image": "${product.image}",
  "offers": {
    "@type": "Offer",
    "availability": "https://schema.org/InStock",
    "priceCurrency": "TWD",
    "seller": {
      "@type": "Organization",
      "name": "OrionStar Taiwan"
    }
  },
  "aggregateRating": {
    "@type": "AggregateRating",
    "ratingValue": "4.8",
    "reviewCount": "156"
  },
  "additionalProperty": [
    ${Object.entries(product.specifications).map(([key, value]) => `{
      "@type": "PropertyValue",
      "name": "${key}",
      "value": "${value}"
    }`).join(',')}
  ]
}
</script>

<!-- 產品詳情頁面 -->
<div class="container py-5">
    <!-- 麵包屑導航 -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="/">首頁</a></li>
            <li class="breadcrumb-item"><a href="/products">產品中心</a></li>
            <li class="breadcrumb-item active" aria-current="page">${product.name}</li>
        </ol>
    </nav>

    <div class="row">
        <!-- 產品圖片 -->
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm">
                <div class="card-body text-center p-0">
                    <div class="product-main-image" style="height: 400px; background-image: url('${product.image}'); background-size: cover; background-position: center; border-radius: 0.375rem 0.375rem 0 0;"></div>
                    <div class="p-4">
                        <h4 class="text-primary">${product.name}</h4>
                        <p class="text-muted mb-0">${product.category}</p>
                    </div>
                </div>
            </div>
            
            <!-- 產品圖片庫 -->
            <div class="row mt-3">
                ${product.gallery.map((image, index) => `
                <div class="col-4 mb-2">
                    <div class="product-gallery-image" style="height: 80px; background-image: url('${image}'); background-size: cover; background-position: center; border-radius: 0.375rem; cursor: pointer;" onclick="changeMainImage('${image}')"></div>
                </div>
                `).join('')}
            </div>
        </div>

        <!-- 產品資訊 -->
        <div class="col-lg-6">
            <div class="card shadow-sm h-100">
                <div class="card-body">
                    <h1 class="card-title text-primary mb-3">${product.name} - 專業${product.category}解決方案</h1>
                    <p class="lead text-muted mb-4">${product.description}</p>
                    
                    <!-- SEO優化的產品介紹 -->
                    <div class="mb-4">
                        <h3 class="h5 fw-bold mb-3">產品概述</h3>
                        <p class="text-muted">
                            ${product.name}是一款專業的${product.category}，採用先進的人工智能技術和自主導航系統，
                            為${product.category.includes('遞送') ? '餐飲、醫療、零售' : product.category.includes('接待') ? '酒店、展覽、辦公' : product.category.includes('工業') ? '工廠、倉庫、物流' : '商業、公共' }等行業提供智能化解決方案。
                            憑藉其卓越的性能和可靠性，${product.name}已成為業界領先的${product.category}品牌。
                        </p>
                    </div>
                    
                    <!-- 主要功能特色 -->
                    <div class="mb-4">
                        <h5 class="fw-bold mb-3">
                            <i class="fas fa-star text-warning me-2"></i>
                            主要功能特色
                        </h5>
                        <div class="row">
                            ${product.features.map(feature => `
                            <div class="col-md-6 mb-2">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-check-circle text-success me-2"></i>
                                    <span>${feature}</span>
                                </div>
                            </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- 技術規格 -->
                    <div class="mb-4">
                        <h5 class="fw-bold mb-3">
                            <i class="fas fa-cogs text-primary me-2"></i>
                            技術規格
                        </h5>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <tbody>
                                    ${Object.entries(product.specifications).map(([key, value]) => `
                                    <tr>
                                        <td class="fw-bold text-muted">${key}</td>
                                        <td>${value}</td>
                                    </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 操作按鈕 -->
                    <div class="d-grid gap-2 d-md-flex">
                        <button class="btn btn-primary btn-lg flex-fill me-md-2" data-bs-toggle="modal" data-bs-target="#contactModal">
                            <i class="fas fa-phone me-2"></i>
                            聯繫我們
                        </button>
                        <button class="btn btn-outline-primary btn-lg flex-fill" data-bs-toggle="modal" data-bs-target="#quoteModal">
                            <i class="fas fa-file-alt me-2"></i>
                            索取報價
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 相關產品推薦 -->
    <div class="row mt-5">
        <div class="col-12">
            <h3 class="fw-bold mb-4">
                <i class="fas fa-lightbulb text-warning me-2"></i>
                相關產品推薦
            </h3>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <div style="height: 120px; background-image: url('/images/products/luckibot/luckibot.jpg'); background-size: cover; background-position: center; border-radius: 0.375rem; margin-bottom: 1rem;"></div>
                            <h5 class="card-title">LuckiBot</h5>
                            <p class="card-text text-muted">基礎版遞送服務機器人</p>
                            <a href="/products/1" class="btn btn-sm btn-outline-primary">查看詳情</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <div style="height: 120px; background-image: url('/images/products/mini/greeting-robot-mini.jpg'); background-size: cover; background-position: center; border-radius: 0.375rem; margin-bottom: 1rem;"></div>
                            <h5 class="card-title">GreetingBot Mini</h5>
                            <p class="card-text text-muted">小巧靈活的接待機器人</p>
                            <a href="/products/4" class="btn btn-sm btn-outline-primary">查看詳情</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body text-center">
                            <div style="height: 120px; background-image: url('/images/products/carrybot/carrybot.jpg'); background-size: cover; background-position: center; border-radius: 0.375rem; margin-bottom: 1rem;"></div>
                            <h5 class="card-title">CarryBot</h5>
                            <p class="card-text text-muted">工業級配送機器人</p>
                            <a href="/products/7" class="btn btn-sm btn-outline-primary">查看詳情</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 聯繫我們 Modal -->
<div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contactModalLabel">聯繫我們</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>如需了解更多關於 <strong>${product.name}</strong> 的資訊，請聯繫我們的專業團隊：</p>
                <ul class="list-unstyled">
                    <li><i class="fas fa-phone text-primary me-2"></i> +886-2-1234-5678</li>
                    <li><i class="fas fa-envelope text-primary me-2"></i> info@orionstar.com.tw</li>
                    <li><i class="fas fa-clock text-primary me-2"></i> 週一至週五 9:00-18:00</li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">關閉</button>
                <a href="/contact" class="btn btn-primary">前往聯繫頁面</a>
            </div>
        </div>
    </div>
</div>

<!-- 索取報價 Modal -->
<div class="modal fade" id="quoteModal" tabindex="-1" aria-labelledby="quoteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="quoteModalLabel">索取報價</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label for="companyName" class="form-label">公司名稱</label>
                        <input type="text" class="form-control" id="companyName" required>
                    </div>
                    <div class="mb-3">
                        <label for="contactName" class="form-label">聯絡人姓名</label>
                        <input type="text" class="form-control" id="contactName" required>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">電子郵件</label>
                        <input type="email" class="form-control" id="email" required>
                    </div>
                    <div class="mb-3">
                        <label for="phone" class="form-label">聯絡電話</label>
                        <input type="tel" class="form-control" id="phone" required>
                    </div>
                    <div class="mb-3">
                        <label for="quantity" class="form-label">需求數量</label>
                        <select class="form-select" id="quantity" required>
                            <option value="">請選擇</option>
                            <option value="1">1台</option>
                            <option value="2-5">2-5台</option>
                            <option value="6-10">6-10台</option>
                            <option value="10+">10台以上</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label for="message" class="form-label">其他需求說明</label>
                        <textarea class="form-control" id="message" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">取消</button>
                <button type="button" class="btn btn-primary">送出詢價</button>
            </div>
        </div>
    </div>
</div>

<script>
function changeMainImage(imageUrl) {
    document.querySelector('.product-main-image').style.backgroundImage = \`url('\${imageUrl}')\`;
}
</script>

<style>
.product-gallery-image {
    transition: transform 0.3s ease;
}

.product-gallery-image:hover {
    transform: scale(1.05);
}

.product-main-image {
    transition: background-image 0.3s ease;
}
</style>
`
}) %>